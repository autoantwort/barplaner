datasource db {
  provider = "sqlite"
  url      = "file:data.sqlite"
}

generator client {
  provider = "prisma-client-js"
}

model UserRoles {
  userId    Int
  roleName  String
  roles     Roles    @relation(fields: [roleName], references: [name], onDelete: Cascade) @ignore
  users     Users    @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@id([userId, roleName])
}

model Answers {
  userId     Int
  questionId Int
  value      String?   @default("no_answer")
  questions  Questions @relation(fields: [questionId], references: [id], onDelete: Cascade)
  users      Users     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@id([userId, questionId])
}

model Barduties {
  barID         Int
  userID        Int
  state         String?                    @default("no_info")
  job           String?                    @default("")
  from          String?                    @default("")
  to            String?                    @default("")
  have_to_clean Boolean?                   @default(false)
  bars          Bars                       @relation(fields: [barID], references: [id], onDelete: NoAction, onUpdate: NoAction)
  users         Users                      @relation(fields: [userID], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@id([barID, userID])
}

model Bars {
  id                    Int                        @id @default(autoincrement())
  name                  String?
  description           String?
  public                Boolean?                   @default(true)
  canceled              Boolean?                   @default(false)
  start                 DateTime?
  end                   DateTime?
  facebookEventID       String?
  facebookCoverImageURL String?
  barduties             Barduties[]
}

model Files {
  id                              String     @id
  filename                        String?
  mimeType                        String?
  telegramFileId                  String?
  images_filesToimages_compressed Images[]   @relation("filesToimages_compressed")
  images_filesToimages_original   Images[]   @relation("filesToimages_original")
  invoices                        Invoices[]
}

model Images {
  id                             Int              @id @default(autoincrement())
  titel                          String?
  original                       String?
  compressed                     String?
  files_filesToimages_compressed Files?           @relation("filesToimages_compressed", fields: [compressed], references: [id])
  files_filesToimages_original   Files?           @relation("filesToimages_original", fields: [original], references: [id])
  stockItems                     StockItems[]
  stockPositions                 StockPositions[]
}

model InvoiceEntries {
  id              Int            @id @default(autoincrement())
  itemDescription String
  articleNumber   String?
  gtin            String?
  quantity        Int
  amount          Int?
  unit            String?
  netPrice        Decimal?
  brottoPrice     Decimal?
  images          String?
  productSite     String?
  alcoholByVolume Decimal?
  invoiceId       Int?
  stockItemId     Int?
  invoices        Invoices?      @relation(fields: [invoiceId], references: [id])
  stockItems      StockItems?    @relation(fields: [stockItemId], references: [id])
  stockChanges    StockChanges[]
}

model Invoices {
  id                    Int              @id @default(autoincrement())
  deliveryDate          DateTime?
  invoiceDate           DateTime?
  seller                String?
  extraCostsDescription String?
  extraCostsAmount      Decimal?
  fileId                String?
  files                 Files?           @relation(fields: [fileId], references: [id])
  invoiceEntries        InvoiceEntries[]
}

model ItemGroups {
  id                   Int             @id @default(autoincrement())
  name                 String?         @unique(map: "sqlite_autoindex_itemGroups_1")
  nameColognePhonetics String?
  minimumCount         Decimal?        @default(0)
  idealCount           Decimal?
  stockPositionId      Int?
  stockPositions       StockPositions? @relation(fields: [stockPositionId], references: [id])
  stockItems           StockItems[]
}

model Questions {
  id        Int       @id @default(autoincrement())
  text      String?
  surveyId  Int?
  surveys   Surveys?  @relation(fields: [surveyId], references: [id], onDelete: Cascade)
  answers   Answers[]
}

model Roles {
  name        String      @id
  description String?
  UserRoles   UserRoles[]
  settings    Settings[]
}

model Settings {
  name        String   @id
  permission  String?
  description String?  @default("")
  value       String?  @default("")
  roles       Roles?   @relation(fields: [permission], references: [name], onDelete: NoAction, onUpdate: NoAction)
}


model ShouldDeletes {
  chatID      BigInt
  messageID   BigInt
  deleteAfter DateTime?
  newText     String?

  @@id([chatID, messageID])
}

model StockChanges {
  id             Int             @id @default(autoincrement())
  date           DateTime
  netPrice       Decimal?
  brottoPrice    Decimal?
  amount         Decimal
  priceAccuracy  String?
  reason         String?
  note           String?
  itemId         Int
  userId         Int?
  invoiceEntryId Int?
  invoiceEntries InvoiceEntries? @relation(fields: [invoiceEntryId], references: [id])
  stockItems     StockItems      @relation(fields: [itemId], references: [id], onDelete: NoAction)
  users          Users?          @relation(fields: [userId], references: [id])
}

model StockItems {
  id                   Int              @id @default(autoincrement())
  name                 String?
  nameColognePhonetics String?
  barcode              String?
  articleNumber        String?
  seller               String?
  amount               Int?
  unit                 String?
  internalNote         String?
  website              String?
  alcoholByVolume      Decimal?
  itemGroupId          Int?
  stockPositionId      Int?
  imageId              Int?
  images               Images?          @relation(fields: [imageId], references: [id])
  itemGroups           ItemGroups?      @relation(fields: [itemGroupId], references: [id])
  stockPositions       StockPositions?  @relation(fields: [stockPositionId], references: [id])
  invoiceEntries       InvoiceEntries[]
  stockChanges         StockChanges[]

  @@unique([barcode, seller], map: "sqlite_autoindex_stockItems_1")
}

model StockPositions {
  id                   Int          @id @default(autoincrement())
  name                 String?      @unique(map: "sqlite_autoindex_stockPositions_1")
  nameColognePhonetics String?
  description          String?
  xPositionOnImage     Float?
  yPositionOnImage     Float?
  room                 String?
  imageId              Int?
  images               Images?      @relation(fields: [imageId], references: [id])
  itemGroups           ItemGroups[]
  stockItems           StockItems[]
}

model Surveys {
  id                   Int                        @id @default(autoincrement())
  question             String?
  creatorId            Int?
  end                  DateTime?
  allowMultipleAnswers Boolean?
  users                Users?                     @relation(fields: [creatorId], references: [id])
  questions            Questions[]
}

model TelegramNewsletters {
  chatId         Int                        @id @default(autoincrement())
  enabled        Boolean?                   @default(true)
  sendAt         String?                    @default("1500")
  sendDaysBefore String?                    @default("[0,1,3,8]")
}

model Users {
  id                                         Int                        @id @default(autoincrement())
  name                                       String?                    @unique(map: "sqlite_autoindex_users_1")
  password                                   String?
  email                                      String?
  phone                                      String?
  telegramID                                 String?
  gitLabID                                   Int?
  active                                     Boolean?                   @default(true)
  sessionID                                  String?                    @unique(map: "sqlite_autoindex_users_2")
  experienced_cleaner                        Boolean?                   @default(false)
  birthday                                   String?
  only_show_gitlab_notifications_if_assigned Boolean                    @default(false)
  UserRoles                                  UserRoles[]
  answers                                    Answers[]
  barduties                                  Barduties[]
  stockChanges                               StockChanges[]
  surveys                                    Surveys[]
}

model WebPushSubscriptions {
  endpoint     String  @id
  subscription String?
}
